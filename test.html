<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>培养基配制助手</title>
    <style type="text/css">
        table {
            border-collapse: collapse;
        }

        td {
            text-align: center;
            padding: 7px;
            ;
        }
    </style>
    <script>
        var ypd = []
        ypd[1] = ["YPD培养基", "YPD种子培养基", "液体", "10"];
        ypd[2] = ["YPD培养基", "YPD摇瓶培养基", "液体", "50"];
        ypd[3] = ["YPD培养基", "YPD固体培养基", "固体", "50"];
        ypd[4] = ["YPD培养基", "YPD固体培养基", "固体", "100"];
        var lb = []
        lb[1] = ["LB培养基", "LB种子培养基", "液体", "10"];
        lb[2] = ["LB培养基", "LB摇瓶培养基", "液体", "50"];
        lb[3] = ["LB培养基", "LB固体培养基", "固体", "50"];
        lb[4] = ["LB培养基", "LB固体培养基", "固体", "100"];
        var mm = []
        mm[1] = ["MM培养基", "MM摇瓶培养基", "液体", "50"];
        mm[2] = ["MM培养基", "MM固体培养基", "固体", "50"];
        mm[3] = ["MM培养基", "MM固体培养基", "固体", "100"];
        var fm = []
        fm[1] = ["发酵培养基", "发酵摇瓶培养基", "液体", "30"];
        var medall = ["", ypd, lb, mm, fm]
        var med = [], ypdadd = [], lbadd = [], mmadd = [], fmadd = []
        function sel() {    //培养基类型函数
            document.getElementById("sele").selectedIndex = 0
            able()
            var ki = document.getElementById("kind").selectedIndex
            switch (ki) {
                case 0:
                    document.getElementById("sele").innerHTML = "\
                    <option>请选择培养基类型</option>"
                    break
                case 1:
                    document.getElementById("sele").innerHTML = "\
                    <option>请选择培养基类型</option>\
                        <option>YPD种子培养基(10mL)</option >\
                        <option>YPD摇瓶培养基(50mL)</option>\
                        <option>YPD固体培养基(50mL)</option>\
                        <option>YPD固体培养基(100mL)</option>"
                    break
                case 2:
                    document.getElementById("sele").innerHTML = "\
                    <option>请选择培养基类型</option>\
                        <option>LB种子培养基(10mL)</option >\
                        <option>LB摇瓶培养基(50mL)</option>\
                        <option>LB固体培养基(50mL)</option>\
                        <option>LB固体培养基(100mL)</option>"
                    break
                case 3:
                    document.getElementById("sele").innerHTML = "\
                    <option>请选择培养基类型</option>\
                        <option>MM摇瓶培养基(50mL)</option>\
                        <option>MM固体培养基(50mL)</option>\
                        <option>MM固体培养基(100mL)</option>"
                    break
                case 4:
                    document.getElementById("sele").innerHTML = "\
                    <option>请选择培养基类型</option>\
                        <option>发酵固体培养基(3mL)</option>"
                    break
            }
        }
        function able() {
            if (document.getElementById("kind").selectedIndex == 0 |
                document.getElementById("sele").selectedIndex == 0 |
                document.getElementById("num").selectedIndex == 0) {
                document.getElementById("submit").disabled = "disable"
            }
            else { document.getElementById("submit").removeAttribute("disabled") }
            if (med.length == 0) {
                document.getElementById("begin").disabled = "disable"
            }
            else { document.getElementById("begin").removeAttribute("disabled") }
        }
        function sub() {    //培养基提交函数
            var medl = [],
                dig = document.getElementById("num").value,
                nc = med.length
            i = document.getElementById("kind").selectedIndex
            j = document.getElementById("sele").selectedIndex
            medl[0] = medall[i][j][0]
            medl[1] = medall[i][j][1]
            medl[2] = medall[i][j][2]
            medl[3] = medall[i][j][3]
            medl[4] = dig
            med[nc] = medl
            print()
            able()

        }
        function print() {
            document.getElementById("subtable").innerHTML = "\
                <caption><b>待计算培养基</b></caption>\
                    <tr>\
                    <th>名称</th>\
                    <th>类型</th>\
                    <th>物态</th>\
                    <th>单体积/mL</th>\
                    <th>数量/瓶</th>\
                    <th>&nbsp;<button type='button' onclick='del()'>删除</button>&nbsp;</th></tr>"
            var onesub = ""
            for (var i = 0; i < med.length; i++) {
                var medc = []
                medc = med[i]
                for (var k = 0; k < medc.length; k++) {
                    onesub += "<th>" + medc[k] + "</th>"
                }
                onesub += "\
                <th><input type=checkbox name='cbx'></th>\
             </tr>"
            }
            document.getElementById("subtable").innerHTML = document.getElementById("subtable").innerHTML + onesub
        }
        function del() {
            var de1 = document.getElementsByName("cbx")
            var de2 = []
            var len = de1.length - 1
            for (var i = len; i > -1; i--) {
                if (de1[i].checked == true) {
                    delary(i)
                }

            }
            print()
        }
        function delary(ar) {

            var ary1 = []
            var ary2 = []
            for (var i = 0; i < ar; i++) {
                ary1[i] = med[i]
                med.shift()
            }
            med.shift()
            for (var j = 0; j < med.length; j++) { ary2[j] = med[j] }

            var len2 = ary1.length + ary2.length
            for (var k = 0; k < len2; k++) {
                if (k < ary1.length) { med[k] = ary1[k] }
                else { med[k] = ary2[k - ary1.length] }
            }
        }
        function cle() {  //汇总案清空函数
            document.getElementById("sign2").innerHTML = ""
            document.getElementById("sogly").innerHTML = ""
            document.getElementById("sotpt").innerHTML = ""
            document.getElementById("soyst").innerHTML = ""
            document.getElementById("sowater").innerHTML = ""
            document.getElementById("sign1").innerHTML = ""
            document.getElementById("sbottle").innerHTML = ""
            document.getElementById("mbottle").innerHTML = ""
            document.getElementById("lbottle").innerHTML = ""
            document.getElementById("soagar").innerHTML = ""
            med = []
            print()
        }
        function chaofeng() {       //嘲讽函数
            document.getElementById("sign1").innerHTML = "<h2>您配培养基吗？</h2><h1>您不配！</h1>"
            document.getElementById("sign2").innerHTML = ""
            document.getElementById("sogly").innerHTML = ""
            document.getElementById("sotpt").innerHTML = ""
            document.getElementById("soyst").innerHTML = ""
            document.getElementById("sowater").innerHTML = ""
            document.getElementById("sbottle").innerHTML = ""
            document.getElementById("mbottle").innerHTML = ""
            document.getElementById("lbottle").innerHTML = ""
            document.getElementById("soagar").innerHTML = ""
            able()
        }
        function devide() {
            ypdadd = []; lbadd = []; mmadd = []; fmadd = [];
            for (var i = 0; i < med.length; i++) {
                switch (med[i][0]) {
                    case "YPD培养基":
                        ypdadd[ypdadd.length] = med[i]
                        break
                    case "LB培养基":
                        lbadd[lbadd.length] = med[i]
                        break
                    case "MM培养基":
                        mmadd[mmadd.length] = med[i]
                        break
                    case "发酵培养基":
                        fmadd[fmadd.length] = med[i]
                        break
                }
            }
            ypdjisuan()
            // lbjisuan()
            // mmjisuan()
            // fmjisuan()
        }
        function ypdjisuan() {
            var s1 = 0, s2 = 0, n1 = 0, d1 = 0, l1 = 0, mb = 0, gly = 0, tpt = 0, yst = 0, agar = 0;
            for (var i = 0; i < ypdadd.length; i++) {
                switch (ypdadd[i][1]) {
                    case "YPD种子培养基":
                        s1 += ypdadd[i][4] / 1
                        break
                    case "YPD摇瓶培养基":
                        n1 += ypdadd[i][4] / 1
                        break
                    case "YPD固体培养基":
                        if (ypdadd[i][3] == 50) { d1 += ypdadd[i][4] / 1 }
                        else { l1 += ypdadd[i][4] / 1 }
                        break
                }
            }
            console.log(n1)
            s2 = s1 * 10 + n1 * 50 + d1 * 50 + l1 * 100
            gly = s2 / 50		//葡萄糖总需求量
            tpt = s2 / 50		//蛋白胨总需求量
            yst = s2 / 100		//酵母粉总需求量
            mb = n1 / 1 + l1 / 1
            agar = d1 / 1 + l1 / 1
            if (s2 > 0) {
                document.getElementById("sign2").innerHTML = "<b>您本次配制需要准备的药品如下：</b>"
                document.getElementById("sogly").innerHTML = gly + "g 葡萄糖"
                document.getElementById("sotpt").innerHTML = tpt + "g 蛋白胨"
                document.getElementById("soyst").innerHTML = yst + "g 酵母粉"
                document.getElementById("sowater").innerHTML = s2 + "mL 去离子水"
            }
            else { chaofeng() }
            if (s1 > 0) {		//种子培养基个数不为零，输出小瓶量
                document.getElementById("sign1").innerHTML = "<b>您本次配制需要准备的器材如下：</b>"
                document.getElementById("sbottle").innerHTML = "<p>" + s1 + "个 50mL小三角瓶</p><p>1个 10mL注射器</p>"
            }
            else { document.getElementById("sbottle").innerHTML = "" }

            if (n1 > 0) {		//摇瓶培养基个数不为零，输出中瓶量
                document.getElementById("sign1").innerHTML = "<b>您本次配制需要准备的器材如下：</b>"
                document.getElementById("lbottle").innerHTML = "<p>" + mb + "个 250mL中三角瓶</p>"
            }
            else { document.getElementById("lbottle").innerHTML = "" }
            if (d1 > 0) {       //  小固体培养基需瓶量
                document.getElementById("sign1").innerHTML = "<b>您本次配制需要准备的器材如下：</b>"
                document.getElementById("mbottle").innerHTML = "<p>" + d1 + "个 100mL三角瓶</p>"
                document.getElementById("soagar").innerHTML = d1 + "份 1g的琼脂粉"
            }
            else {
                document.getElementById("soagar").innerHTML = ""
                document.getElementById("mbottle").innerHTML = ""
            }
            if (l1 > 0) {       //  中固体培养基需瓶量
                document.getElementById("sign1").innerHTML = "<b>您本次配制需要准备的器材如下：</b>"
                document.getElementById("lbottle").innerHTML = "<p>" + mb + "个 250mL中三角瓶</p>"
                document.getElementById("soagar").innerHTML = l1 + "份 2g的琼脂粉"
            }
            else {
                document.getElementById("soagar").innerHTML = ""
            }
            if (d1 * l1 != 0) { document.getElementById("soagar").innerHTML = agar + "份 琼脂粉,其中1g " + d1 + "份，2g " + l1 + "份" }
            if (n1 + l1 == 0) { document.getElementById("lbottle").innerHTML = "" }
        }
        function lbjisuan() {

        }
        function mmjisuan() {

        }
        function fmjisuan() {

        }
    </script>

</head>

<body>
    <h1>培养基配制助手2.0</h1>
    <p>
        <select id="kind" onchange="sel()">
            <option>请选择培养基名称</option>
            <option>YPD培养基</option>
            <option>LB培养基</option>
            <option>MM培养基</option>
            <option>Candida glycerinogenes发酵培养基</option>
        </select>
    </p>
    <p>
        <select id="sele" onchange="able()">
            <option>请选择培养基类型</option>
        </select>
    </p>
    <p>
        <select id="num" onchange="able()">
            <option>请选择培养基数量</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>6</option>
            <option>7</option>
            <option>8</option>
            <option>9</option>
            <option>10</option>
            <option>11</option>
            <option>12</option>
            <option>13</option>
            <option>14</option>
            <option>15</option>
            <option>16</option>
            <option>17</option>
            <option>18</option>
            <option>19</option>
            <option>20</option>
            <option>21</option>
            <option>22</option>
            <option>23</option>
            <option>24</option>
            <option>25</option>
            <option>26</option>
            <option>27</option>
            <option>28</option>
            <option>29</option>
            <option>30</option>
        </select>
        <button type="button" onclick="sub()" id="submit" disabled="">提交</button>
    </p>
    <table border='1' id="subtable">
        <caption><b>待计算培养基</b></caption>
        <tr>
            <th>名称</th>
            <th>类型</th>
            <th>物态</th>
            <th>单体积/mL</th>
            <th>数量/瓶</th>
            <th>&nbsp;<button type="button" onclick="del()">删除</button>&nbsp;</th>
        </tr>
    </table>
    <p><button type="button" onclick="devide()" id="begin">开始计算</button>
        <button type="reset" onclick="cle()">重置</button></p>
    <p id="sign1"></p>
    <p id="sbottle"></p>
    <p id="mbottle"></p>
    <p id="lbottle"></p>
    <p id="sign2"></p>
    <p id="sogly"></p>
    <p id="sotpt"></p>
    <p id="soyst"></p>
    <p id="sowater"></p>
    <p id="soagar"></p>
    <p id="step"></p>
</body>

</html>